{"version":3,"file":"server.js","names":["_express","_interopRequireDefault","require","_morgan","_cors","_helmet","_helpers","__rutas","_interopRequireWildcard","__rutasAuth","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","app","express","use","morgan","cors","origin","json","limit","urlencoded","extended","helmet","process","env","NODE_ENV","config","isDev","Promise","all","map","dynamicImport","specifier","concat","then","s","_ref","jwt","db","req","res","query","user","status","mensaje","usuario","User","findOne","where","user_mail","token","sign","user_id","id","API_KEY","expiresIn","_req","name","Autor","API_URL","PREFIX","ROUTER","entries","forEach","entry","_key","value","API_ENDPOINT","port","DB_PORT","server","listen","error","console","log","address"],"sources":["../server.js"],"sourcesContent":["import express from 'express';\r\nimport morgan from 'morgan';\r\nimport cors from 'cors';\r\nimport helmet from 'helmet';\r\nimport { isDev } from './helpers';\r\nimport * as __rutas from './routes';\r\nimport * as __rutasAuth from './routes/_auth.routes';\r\n\r\nconst app = express();\r\napp.use(morgan('dev'));\r\napp.use(cors({ origin: '*' }));\r\napp.use(express.json({ limit: '50mb' }));\r\napp.use(express.urlencoded({ limit: '50mb', extended: true }));\r\napp.use(helmet());\r\n\r\nif( process.env.NODE_ENV === 'production' ){\r\n  require('dotenv').config();\r\n}\r\n\r\nif (isDev()) {\r\n  Promise.all(['jsonwebtoken', './database/models'].map(dynamicImport => (import(dynamicImport)))).then(([jwt, db]) => {\r\n    app.get('/get-token', async (req, res) => {\r\n      if (!req.query.user) return res.status(400).json({ mensaje: 'El usuario es obligatorio' });\r\n      const usuario = await db.User.findOne({ where: { user_mail: req.query.user } });\r\n      if (usuario) {\r\n        const token = jwt.sign({ user_id: usuario.id }, process.env.API_KEY, { expiresIn: '1d' });\r\n        res.status(200).json({ token });\r\n      } else {\r\n        res.status(403).json({ mensaje: 'No tienes permisos' });\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\napp.get('/', (_req, res) => {\r\n  res.json({\r\n    name: 'FuturoCO',\r\n    Autor: 'AtodoSoftware'\r\n  });\r\n})\r\n\r\napp.use(process.env.API_URL + __rutasAuth.PREFIX, __rutasAuth.ROUTER);\r\n\r\nObject.entries(__rutas.default).forEach(entry => {\r\n  const [_key, value] = entry;\r\n  const API_URL = process.env.API_ENDPOINT + value.PREFIX;\r\n  app.use(API_URL, value.ROUTER);\r\n});\r\nconst port = process.env.DB_PORT || 3002;\r\nconst server = app.listen(port, error => {\r\n  if (error) return console.log(`Error: ${error}`);\r\n  console.log(`Server jalando en el puerto: ${server.address().port}`);\r\n})"],"mappings":"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"}