{"version":3,"file":"token_verifications.js","names":["_interopRequireDefault","require","_sequelize","op","seq","Op","Model","module","exports","sequelize","DataTypes","Token","associate","models","belongsTo","User","foreignKey","allowNull","init","token_id","primaryKey","type","INTEGER","autoIncrement","token_uniqueString","STRING","max","token_expiredAt","DATE","modelName","tableName","timestamps","paranoid","createdAt","updatedAt","deletedAt","defaultScope","where","ne","scopes","deleted","emptyToken","include","model"],"sources":["../../../src/database/models/token_verifications.js"],"sourcesContent":["'use strict';\r\nimport seq from \"sequelize\";\r\nconst op = seq.Op;\r\n\r\nconst {\r\n  Model\r\n} = require('sequelize');\r\nmodule.exports = (sequelize, DataTypes) => {\r\n  class Token extends Model {\r\n    /**\r\n     * Helper method for defining associations.\r\n     * This method is not a part of Sequelize lifecycle.\r\n     * The `models/index` file will call this method automatically.\r\n     */\r\n    static associate(models) {\r\n      // define association here\r\n      Token.belongsTo(models.User, {\r\n        foreignKey: 'user_id',\r\n        allowNull: false\r\n      })\r\n    }\r\n  }\r\n  Token.init(\r\n  {\r\n    token_id: {\r\n      primaryKey: true,\r\n      type: DataTypes.INTEGER,\r\n      autoIncrement: true\r\n    },\r\n    token_uniqueString: {\r\n      type: DataTypes.STRING,\r\n      max: 150\r\n    },\r\n    token_expiredAt:{\r\n      type: DataTypes.DATE\r\n    }\r\n  }, \r\n  {\r\n    sequelize,\r\n    modelName: 'Token',\r\n    tableName: 'token_verifications',\r\n    timestamps: true,\r\n    paranoid: true,\r\n    createdAt: 'token_createdAt',\r\n    updatedAt: 'token_updatedAt',\r\n    deletedAt: 'token_deletedAt',\r\n  },\r\n  {\r\n    defaultScope: {\r\n      where: {\r\n        token_expiredAt: {\r\n          [op.ne]: null\r\n        }\r\n      }\r\n    },\r\n    scopes: {\r\n      deleted: {\r\n        where: {\r\n          deleted: true\r\n        }\r\n      },\r\n      emptyToken: {\r\n        include: [\r\n          { model: Token, where: { token_uniqueString: \"\" } }\r\n        ]\r\n      }\r\n    }\r\n  }\r\n  );\r\n  return Token;\r\n};"],"mappings":"AAAA,YAAY;;AAAC,IAAAA,sBAAA,GAAAC,OAAA;AACb,IAAAC,UAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,MAAME,EAAE,GAAGC,kBAAG,CAACC,EAAE;AAEjB,MAAM;EACJC;AACF,CAAC,GAAGL,OAAO,CAAC,WAAW,CAAC;AACxBM,MAAM,CAACC,OAAO,GAAG,CAACC,SAAS,EAAEC,SAAS,KAAK;EACzC,MAAMC,KAAK,SAASL,KAAK,CAAC;IACxB;AACJ;AACA;AACA;AACA;IACI,OAAOM,SAASA,CAACC,MAAM,EAAE;MACvB;MACAF,KAAK,CAACG,SAAS,CAACD,MAAM,CAACE,IAAI,EAAE;QAC3BC,UAAU,EAAE,SAAS;QACrBC,SAAS,EAAE;MACb,CAAC,CAAC;IACJ;EACF;EACAN,KAAK,CAACO,IAAI,CACV;IACEC,QAAQ,EAAE;MACRC,UAAU,EAAE,IAAI;MAChBC,IAAI,EAAEX,SAAS,CAACY,OAAO;MACvBC,aAAa,EAAE;IACjB,CAAC;IACDC,kBAAkB,EAAE;MAClBH,IAAI,EAAEX,SAAS,CAACe,MAAM;MACtBC,GAAG,EAAE;IACP,CAAC;IACDC,eAAe,EAAC;MACdN,IAAI,EAAEX,SAAS,CAACkB;IAClB;EACF,CAAC,EACD;IACEnB,SAAS;IACToB,SAAS,EAAE,OAAO;IAClBC,SAAS,EAAE,qBAAqB;IAChCC,UAAU,EAAE,IAAI;IAChBC,QAAQ,EAAE,IAAI;IACdC,SAAS,EAAE,iBAAiB;IAC5BC,SAAS,EAAE,iBAAiB;IAC5BC,SAAS,EAAE;EACb,CAAC,EACD;IACEC,YAAY,EAAE;MACZC,KAAK,EAAE;QACLV,eAAe,EAAE;UACf,CAACxB,EAAE,CAACmC,EAAE,GAAG;QACX;MACF;IACF,CAAC;IACDC,MAAM,EAAE;MACNC,OAAO,EAAE;QACPH,KAAK,EAAE;UACLG,OAAO,EAAE;QACX;MACF,CAAC;MACDC,UAAU,EAAE;QACVC,OAAO,EAAE,CACP;UAAEC,KAAK,EAAEhC,KAAK;UAAE0B,KAAK,EAAE;YAAEb,kBAAkB,EAAE;UAAG;QAAE,CAAC;MAEvD;IACF;EACF,CACA,CAAC;EACD,OAAOb,KAAK;AACd,CAAC"}